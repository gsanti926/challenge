<div class="hotel-search-container">
  <div class="search-form">
    <h1>Search Hotels</h1>

    <div class="form-row">
      <div class="form-group destination-group">
        <label for="destination">Destination</label>
        <input
          type="text"
          id="destination"
          [(ngModel)]="searchText"
          (input)="onSearchInput()"
          (blur)="hideAutocomplete()"
          placeholder="Search city..."
          autocomplete="off"
        />
        @if (showAutocomplete) {
          <div class="autocomplete-dropdown">
            @for (item of autocompleteResults; track item.id) {
              <div class="autocomplete-item" (mousedown)="selectDestination(item)">
                {{ item.name }}
              </div>
            }
          </div>
        }
        @if (loadingAutocomplete) {
          <div class="loading-indicator">Searching...</div>
        }
      </div>

      <div class="form-group">
        <label for="checkin">Check-in</label>
        <input
          type="date"
          id="checkin"
          [(ngModel)]="checkin"
        />
      </div>

      <div class="form-group">
        <label for="checkout">Check-out</label>
        <input
          type="date"
          id="checkout"
          [(ngModel)]="checkout"
        />
      </div>

      <div class="form-group">
        <button class="search-button" (click)="searchHotels()" [disabled]="loadingHotels">
          @if (loadingHotels) {
            Searching...
          } @else {
            Search
          }
        </button>
      </div>
    </div>

    @if (error) {
      <div class="error-message">{{ error }}</div>
    }
  </div>

  @if (hotels.length > 0) {
    <div class="hotels-results">
      <h2>Results ({{ hotels.length }} hotels)</h2>
      <div class="hotels-grid">
        @for (hotel of hotels; track hotel.id) {
          <div class="hotel-card">
            <div class="hotel-image">
              @if (hotel.thumbnail_url || (hotel.images && hotel.images.length > 0)) {
                <img
                  [src]="hotel.thumbnail_url || hotel.images[0]?.url"
                  [alt]="hotel.name"
                />
              } @else {
                <div class="no-image">No image</div>
              }
            </div>
            <div class="hotel-info">
              <h3 class="hotel-name">{{ hotel.name }}</h3>
              <p class="hotel-address">{{ hotel.address }}</p>
              <p class="hotel-location">{{ hotel.city }}, {{ hotel.state }}, {{ hotel.country }}</p>
              @if (hotel.star_rating) {
                <div class="hotel-rating">
                  <span class="stars">
                    @for (star of [1,2,3,4,5].slice(0, hotel.star_rating); track star) {
                      <span>&#9733;</span>
                    }
                  </span>
                </div>
              }
              <div class="hotel-price">
                <span class="price">{{ hotel.currency }} {{ hotel.price }}</span>
                @if (hotel.original_price && hotel.original_price > hotel.price) {
                  <span class="original-price">{{ hotel.currency }} {{ hotel.original_price }}</span>
                }
              </div>
            </div>
          </div>
        }
      </div>
    </div>
  }

  @if (!loadingHotels && hotels.length === 0 && selectedDestination && checkin && checkout) {
    <div class="no-results">No hotels found for your search criteria.</div>
  }
</div>
