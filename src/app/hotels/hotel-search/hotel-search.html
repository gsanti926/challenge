<div class="container my-4">

  <h2 class="mb-4 text-center">Search Hotels</h2>

  <form
    [formGroup]="searchForm"
    (ngSubmit)="search()"
    class="row g-3 align-items-end"
  >

    <!-- Destination -->
    <div class="col-12 col-md-4 position-relative">
      <label class="form-label">Destination</label>
      <input
        type="text"
        class="form-control"
        placeholder="City or destination"
        formControlName="destination"
        autocomplete="off"
      />

      @if (destinations().length) {
        <ul class="list-group position-absolute w-100 z-3">
          @for (d of destinations(); track d.id) {
            <li
              class="list-group-item list-group-item-action"
              (click)="selectDestination(d)"
              style="cursor: pointer"
            >
              {{ d.displayName }}
            </li>
          }
        </ul>
      }
    </div>

    <!-- Check-in -->
    <div class="col-6 col-md-2">
      <label class="form-label">Check-in</label>
      <input
        type="date"
        class="form-control"
        formControlName="checkin"
      />
    </div>

    <!-- Check-out -->
    <div class="col-6 col-md-2">
      <label class="form-label">Check-out</label>
      <input
        type="date"
        class="form-control"
        formControlName="checkout"
      />
    </div>

    <!-- Rooms -->
    <div class="col-6 col-md-2">
      <label class="form-label">Rooms</label>
      <input
        type="number"
        min="1"
        class="form-control"
        formControlName="rooms"
      />
    </div>

    <!-- Guests -->
    <div class="col-6 col-md-2">
      <label class="form-label">Guests</label>
      <input
        type="number"
        min="1"
        class="form-control"
        formControlName="guests"
      />
    </div>

    <!-- Button -->
    <div class="col-12 text-center">
      <button
        type="submit"
        class="btn btn-primary px-5"
        [disabled]="loading()"
      >
        Search
      </button>
    </div>
  </form>

  <!-- Loading -->
  @if (loading()) {
    <div class="text-center my-4">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2">Loading hotels...</p>
    </div>
  }

  <!-- Results -->
  <div class="row mt-4">
    @for (hotel of hotels(); track hotel.id) {
      <div class="col-12 col-md-4 col-lg-3 mb-4">
        <div class="card h-100 shadow-sm">

          <img
            [src]="hotel.image_url"
            class="card-img-top"
            alt="Hotel image"
          />

          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ hotel.name }}</h5>
            <p class="card-text text-muted small">
              {{ hotel.address }}
            </p>

            <div class="mt-auto">
              <span class="fw-bold">
                {{ hotel.price }} {{ hotel.currency }}
              </span>
            </div>
          </div>
        </div>
      </div>
    }
  </div>

</div>
